Pre-Buildステージでエラーが発生する場合、以下の点を確認および調整してエラー解消を試みましょう。

1. JAC-1.0.0.jarの確認

JAC-1.0.0.jarファイルの存在がPre-Buildステージのビルドプロセスに影響している可能性があります。Pre-Buildステージ内で明示的にこのファイルの存在確認を行います。

stage('Pre-Build') {
    steps {
        script {
            // ファイルの存在確認
            def jarExists = fileExists '/jboss-cli-scripts/JAC-1.0.0.jar'
            if (!jarExists) {
                error("JAC-1.0.0.jar not found in /jboss-cli-scripts")
            }
        }
        sh """
        # Mavenビルドの実行
        mvn clean install \
        -f ${POM_APM_COMSRV_WEBAPP_PKG} \
        --global-settings ${GLOBAL_SETTINGS} \
        -DcomTypeA=${params.COMTYPEA} \
        -DskipTests=true
        """
    }
}

fileExistsチェックを使用することで、ファイルの存在を確認でき、存在しない場合はエラーを出力します。

2. 環境変数の問題確認

パイプラインで指定されている環境変数${POM_APM_COMSRV_WEBAPP_PKG}と${GLOBAL_SETTINGS}が正しく設定されているか確認してください。これらが期待通りのパスを指していない場合、Mavenが正しいpom.xmlや設定ファイルを見つけられず、エラーが発生する可能性があります。

次のようにして、環境変数の内容を確認するための出力を追加します：

stage('Pre-Build') {
    steps {
        echo "POM_APM_COMSRV_WEBAPP_PKG: ${POM_APM_COMSRV_WEBAPP_PKG}"
        echo "GLOBAL_SETTINGS: ${GLOBAL_SETTINGS}"
        sh """
        # ファイルの存在確認とパスの表示
        if [ ! -f ${POM_APM_COMSRV_WEBAPP_PKG} ]; then
            echo "POM file not found at ${POM_APM_COMSRV_WEBAPP_PKG}"
            exit 1
        fi
        if [ ! -f ${GLOBAL_SETTINGS} ]; then
            echo "Global settings file not found at ${GLOBAL_SETTINGS}"
            exit 1
        fi

        # Mavenビルドの実行
        mvn clean install \
        -f ${POM_APM_COMSRV_WEBAPP_PKG} \
        --global-settings ${GLOBAL_SETTINGS} \
        -DcomTypeA=${params.COMTYPEA} \
        -DskipTests=true
        """
    }
}

3. MavenとJDKのバージョン確認

指定されているMavenやJDKのバージョンが互換性の問題を引き起こしている可能性もあります。toolsセクションで指定しているバージョンが、ビルドするプロジェクトの要件に合っているか確認してください。